<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:controls="clr-namespace:PuzzleDazzle.Controls"
             xmlns:local="clr-namespace:PuzzleDazzle"
             x:Class="PuzzleDazzle.MazePlayPage"
             Title=""
             Shell.NavBarIsVisible="False"
             BackgroundColor="White">

    <!-- Root grid: maze area fills all space, controls overlay on top -->
    <Grid>

        <!-- Maze fills the entire page, with vertical padding to avoid edge bleed -->
        <controls:PlayMazeView x:Name="PlayMazeView" Margin="0,12,0,12" />

        <!-- Top-left: Back/exit button (icon only) -->
        <Button x:Name="ExitButton"
                Text="{x:Static local:FontAwesomeIcons.ArrowLeft}"
                FontFamily="FontAwesome"
                FontSize="20"
                WidthRequest="44"
                HeightRequest="44"
                CornerRadius="22"
                BackgroundColor="#CC333333"
                TextColor="White"
                HorizontalOptions="Start"
                VerticalOptions="Start"
                Margin="16,16,0,0"
                Padding="0"
                Clicked="OnExitClicked"
                SemanticProperties.Hint="Exit play mode" />

        <!-- Top-right: Timer label -->
        <Border HorizontalOptions="End"
                VerticalOptions="Start"
                Margin="0,16,16,0"
                BackgroundColor="#CC333333"
                StrokeThickness="0"
                Padding="12,6">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="20" />
            </Border.StrokeShape>
            <Label x:Name="TimerLabel"
                   Text="00:00"
                   FontSize="14"
                   FontAttributes="Bold"
                   TextColor="White"
                   VerticalTextAlignment="Center" />
        </Border>

        <!-- Lower-right: Circular joystick (4 directional tap zones) -->
        <controls:JoystickView x:Name="Joystick"
                               HorizontalOptions="End"
                               VerticalOptions="End"
                               Margin="16,0,16,16"
                               WidthRequest="160"
                               HeightRequest="160"
                               DirectionTapped="OnJoystickDirectionTapped" />

        <!-- Completion overlay (hidden until maze is solved) -->
        <Grid x:Name="CompletionOverlay"
              IsVisible="False"
              BackgroundColor="#CC000000">

            <VerticalStackLayout x:Name="CompletionContent"
                                 HorizontalOptions="Center"
                                 VerticalOptions="Center"
                                 Spacing="16"
                                 Padding="32">

                <!-- Animated emoji canvas -->
                <controls:EmojiAnimationView x:Name="EmojiAnimation"
                                             WidthRequest="160"
                                             HeightRequest="160"
                                             HorizontalOptions="Center" />

                <!-- Congratulations text -->
                <Label Text="You did it! ðŸŽ‰"
                       FontSize="28"
                       FontAttributes="Bold"
                       TextColor="White"
                       HorizontalTextAlignment="Center" />

                <!-- Time label -->
                <Label x:Name="CompletionTimeLabel"
                       FontSize="20"
                       TextColor="#FFD700"
                       HorizontalTextAlignment="Center" />

                <!-- Continue button (icon only â€” circle check) -->
                <Button Text="{x:Static local:FontAwesomeIcons.CircleCheck}"
                        FontFamily="FontAwesome"
                        FontSize="32"
                        WidthRequest="68"
                        HeightRequest="68"
                        CornerRadius="34"
                        BackgroundColor="{DynamicResource Primary}"
                        TextColor="White"
                        Padding="0"
                        HorizontalOptions="Center"
                        Clicked="OnContinueClicked"
                        SemanticProperties.Hint="Continue" />

            </VerticalStackLayout>

        </Grid>

    </Grid>

</ContentPage>
