<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:controls="clr-namespace:PuzzleDazzle.Controls"
             xmlns:local="clr-namespace:PuzzleDazzle"
             x:Class="PuzzleDazzle.GenerationPage"
             Title="Maze Generation"
             BackgroundColor="{DynamicResource PageBackgroundColor}">

    <Grid RowDefinitions="Auto,*,Auto">
        
        <!-- Remaining Generations Counter -->
        <Label x:Name="RemainingLabel"
               Grid.Row="0"
               Text="5 of 5 remaining today"
               FontSize="14"
               HorizontalTextAlignment="Center"
               TextColor="{DynamicResource Gray600}"
               Padding="0,6,0,0" />

        <!-- Main Content Area -->
        <Grid Grid.Row="1">
            
            <!-- Welcome Section (shown initially) -->
            <StackLayout x:Name="WelcomeSection"
                        IsVisible="True"
                        VerticalOptions="Center"
                        Padding="40"
                        Spacing="20">
                <Label Text="Mazele Dazzle"
                       FontSize="36"
                       FontAttributes="Bold"
                       HorizontalTextAlignment="Center"
                       TextColor="{DynamicResource Primary}" />
                <Label Text="Press Start to generate your maze"
                       FontSize="18"
                       HorizontalTextAlignment="Center"
                       TextColor="{DynamicResource Gray600}" />
            </StackLayout>
            
            <!-- Progress Indicator (shown during generation) -->
            <StackLayout x:Name="ProgressSection"
                        IsVisible="False"
                        VerticalOptions="Center"
                        Padding="40"
                        Spacing="15">
                <Label Text="Generating your maze..."
                       FontSize="18"
                       FontAttributes="Bold"
                       HorizontalTextAlignment="Center"
                       TextColor="{DynamicResource Primary}" />
                <ActivityIndicator IsRunning="True"
                                 Color="{DynamicResource Primary}"
                                 HeightRequest="50" />
            </StackLayout>

            <!-- Maze Display Area -->
            <Grid x:Name="MazeDisplayArea" IsVisible="False">

                <Border StrokeThickness="0"
                        BackgroundColor="White"
                        Padding="4"
                        Margin="4">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="0" />
                    </Border.StrokeShape>

                    <!-- Actual maze visualization -->
                    <controls:MazeView x:Name="MazeView" />
                </Border>

                <!-- Play button overlay (lower-right corner) -->
                <Button x:Name="PlayButton"
                        Text="ðŸ¸"
                        FontSize="24"
                        WidthRequest="52"
                        HeightRequest="52"
                        CornerRadius="26"
                        BackgroundColor="{DynamicResource Primary}"
                        TextColor="White"
                        HorizontalOptions="End"
                        VerticalOptions="End"
                        Margin="0,0,16,16"
                        Padding="0"
                        Clicked="OnPlayClicked"
                        SemanticProperties.Hint="Play this maze">
                    <Button.Shadow>
                        <Shadow Brush="Black"
                                Opacity="0.25"
                                Radius="8"
                                Offset="0,3" />
                    </Button.Shadow>
                </Button>

            </Grid>
        </Grid>

        <!-- Bottom Button Panel -->
        <Border Grid.Row="2"
                BackgroundColor="White"
                Padding="16,10"
                StrokeThickness="0">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="0" />
            </Border.StrokeShape>
            
            <!-- Shadow effect -->
            <Border.Shadow>
                <Shadow Brush="Black"
                        Opacity="0.1"
                        Radius="10"
                        Offset="0,-2" />
            </Border.Shadow>
            
            <Grid ColumnDefinitions="Auto,*,Auto,*,Auto,*,Auto" ColumnSpacing="0">
                
                <!-- Settings Button (Left) -->
                <Button Grid.Column="0"
                        Text="{x:Static local:FontAwesomeIcons.Gear}"
                        FontFamily="FontAwesome"
                        FontSize="24"
                        WidthRequest="56"
                        HeightRequest="56"
                        CornerRadius="28"
                        BackgroundColor="{DynamicResource Gray100}"
                        TextColor="{DynamicResource Gray700}"
                        Clicked="OnSettingsClicked"
                        Padding="0"
                        SemanticProperties.Hint="Open settings" />
                
                <!-- Spacer -->
                <BoxView Grid.Column="1" BackgroundColor="Transparent" />
                
                <!-- Save Button -->
                <Button Grid.Column="2"
                        x:Name="SaveButton"
                        Text="{x:Static local:FontAwesomeIcons.FloppyDisk}"
                        FontFamily="FontAwesome"
                        FontSize="24"
                        WidthRequest="56"
                        HeightRequest="56"
                        CornerRadius="28"
                        BackgroundColor="{DynamicResource Gray100}"
                        TextColor="{DynamicResource Gray700}"
                        Clicked="OnSaveClicked"
                        IsEnabled="False"
                        Padding="0"
                        Opacity="0.4"
                        SemanticProperties.Hint="Save the generated maze" />
                
                <!-- Spacer -->
                <BoxView Grid.Column="3" BackgroundColor="Transparent" />
                
                <!-- Generate Button (Center, Primary, Larger) -->
                <Button Grid.Column="4"
                        Text="{x:Static local:FontAwesomeIcons.TableCells}"
                        FontFamily="FontAwesome"
                        FontSize="32"
                        WidthRequest="72"
                        HeightRequest="72"
                        CornerRadius="36"
                        BackgroundColor="{DynamicResource Primary}"
                        TextColor="White"
                        Clicked="OnStartClicked"
                        Padding="0"
                        SemanticProperties.Hint="Generate a new maze">
                    <Button.Shadow>
                        <Shadow Brush="{DynamicResource Primary}"
                                Opacity="0.3"
                                Radius="10"
                                Offset="0,4" />
                    </Button.Shadow>
                </Button>
                
                <!-- Spacer -->
                <BoxView Grid.Column="5" BackgroundColor="Transparent" />
                
                <!-- Share Button (Right) -->
                <Button Grid.Column="6"
                        x:Name="ShareButton"
                        Text="{x:Static local:FontAwesomeIcons.ShareNodes}"
                        FontFamily="FontAwesome"
                        FontSize="24"
                        WidthRequest="56"
                        HeightRequest="56"
                        CornerRadius="28"
                        BackgroundColor="{DynamicResource Gray100}"
                        TextColor="{DynamicResource Gray700}"
                        Clicked="OnShareClicked"
                        IsEnabled="False"
                        Padding="0"
                        Opacity="0.4"
                        SemanticProperties.Hint="Share the generated maze" />
                
            </Grid>
        </Border>

    </Grid>

</ContentPage>
